### [密室逃脱（Room escape）](https://codeforces.com/problemset/problem/1398/C)

**时间限制：** 2 s
**内存限制：** 256 MB

**输入：** 标准输入
**输出：** 标准输出



今天，小杨哥来到了青岩古镇的密室逃脱。在密室逃脱中有 $n$ 个房间排成一排，每个房间放有一张卡片，卡片上写着一个数字，参与者只有选择其中连续一段房间（不能不选），进入完成挑战，才能看到卡片上的数字（$0-9$）。最终，如果参与者能够准确的计算出所有进入房间的卡片数字之和，那么他就可以逃脱密室。

然而，小杨哥胆子很小，导致他在完成挑战之后竟然忘记了卡片数字之和，不过，幸运的是，小杨哥还记得他进入了多少个房间，所以他直接喊出了他**进入房间的个数**。 

请你计算，小杨哥可以逃脱密室的不同方案数。

上述题目描述来自于 [2025年ICPC贵州省赛](https://codeforces.com/contestInvitation/09f6ea8e6f4ea5b80a8c4eade945ba4a91769177)，由于该题和 CodeForces 上的一题很像，但 CodeForces 的题目描述有提示，于是我放的是 CodeForces 的链接，填的是省赛的题面。







### 输入

第一行包含一个整数 $t$（$1 \le t \le 1000$），表示测试用例的数量。

每个测试用例的第一行包含一个整数 $n$（$1 \le n \le 10^5$），表示密室的个数。

每个测试用例的第二行包含一个由 $n$ 个十进制数字组成的字符串 $s$，其中 $s_i$ 等于第 $i$ 个密室的卡片数字。

保证所有测试用例中 $n$ 的总和不超过 $10^5$。





### 输出

对每个测试用例，输出一个整数代表小杨哥可以逃脱密室的不同方案数。

 



### 样例

**样例输入：**

```
3
3
120
5
11011
6
600005
```



**样例输出：**

```
3
6
1
```





### 注意

在第二个测试用例中，有 $3$ 个方案：$s_1$，$s_{2 \dots 3}$，$s_{1 \dots 3}$$s_{4 \dots 5}$。

在第二个测试用例中，有 $6$ 个方案：$s_1$，$s_2$，$s_{1 \dots 2}$，$s_4$，$s_5$ 和 $s_{4 \dots 5}$。

在第三个测试用例中，只有一个方案：$s_{2 \dots 6}$。

==这题非常难（代码很短，但不好想），不想作死的可以等明天看题解！！！==





### 题解

我们设前缀和数组为 $m_i$，表示前 $i$ 个房间卡片数字之和。小杨哥进入了连续的一段房间，记这段的左右端点为 $j+1$ 到 $i$，则卡片数字之和为：

$$
m_i - m_j
$$

而根据题意，小杨哥记得自己进入了 $i - j$ 个房间，因此我们有：

$$
m_i - m_j = i - j {\large\text{ }\Longrightarrow\text{ }}m_i - i = m_j - j
$$

也就是说，如果某个位置 $i$ 满足 $m_i - i$ 的值在之前某个位置 $j$ 出现过，那么 $j+1$ 到 $i$ 的房间就是一个合法区间。

最终，所有这样的组合数之和就是小杨哥可以逃脱密室的方案数。



```cpp
void solve()
{
	int n;
	string str;
	cin >> n >> str;
	unordered_map<int, int> nums;

	int ans = 0, pre = 0;
	nums[1] = 1;
	for (int i = 0; i < str.length(); ++i)
	{
		pre += str[i] - '0';
		ans += nums[pre - i];
		nums[pre - i]++;
	}
	cout << ans << endl;
}
```